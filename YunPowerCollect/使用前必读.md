<h1 align="center" style="margin: 30px 0 30px; font-weight: bold;">云捷EMS数据采集系统</h1>
<h4 align="center">使用前必读</h4>


## 一、写在前面
先读readme.md，再往下看！  
云捷EMS系统分为两部分：  
* （1）数据服务部分：包括前端、后端、一次线图等功能  
* （2）数据采集部分：包括采集、解析、存储等功能  

## 二、必须安装的软件及版本
1. JDK1.8、Maven3.5+
2. nacos 2.2.2（只验证了此版本）
3. MySQL 5.7+（推荐8.x版本）
4. MinIO
5. RabbitMQ
6. Redis
7. node.js
8. Sentinel（限流，可选）
9. 部署服务器推荐：Ubuntu 22.04、Ubuntu 24.04

#### RabbitMQ注意事项：
安装完之后，需要创建一个 `yunpower` 的user和 `yunpower` 的virtual host，并赋予权限。


## 三、二次开发
#### 1. 开发环境

* 开发语言：java
* 框架：Springboot-2.7.18
* JDK1.8  
下载地址：https://www.oracle.com/java/technologies/javase/javase8u211-later-archive-downloads.html
* Maven3.5+  
下载地址：https://maven.apache.org/download.cgi
* MYSQL8.x  
安装：https://www.cnblogs.com/hunttown/p/17119331.html  
MYSQL For Windows 下载：https://dev.mysql.com/downloads/installer/
* Linux系统：Ubuntu 24.04 服务器版  
下载地址：https://cn.ubuntu.com/download
* Nacos2.2.2  
文档地址：https://nacos.io/zh-cn/docs/v2/quickstart/quick-start.html
* Redis  
下载地址：https://redis.io/downloads/
* Minio  
下载地址：https://dl.min.io/server/minio/release/linux-amd64/
* RabbitMQ  
下载地址：https://www.rabbitmq.com/download.html

#### 2. 配置host
连接中都是使用host，所以需要将以下配置添加到host文件中。
```
127.0.0.1		nacoshost
127.0.0.1		mysqlhost
127.0.0.1		redishost
127.0.0.1		miniohost
127.0.0.1		mqhost
```

#### 3. 启动Nacos
将 yunpower_cloud、yunpower_collect、yunpower_log、yunpower_config 四个数据库导入MYSQL中；  
设置默认数据库账号：root  密码：123456（如果有修改，请修改nacos中的配置文件）

进入nacos安装目录打开 `conf/application.properties` 文件，在47行的位置插入以下数据库连接代码：

~~~
# db mysql
spring.datasource.platform=mysql
db.num=1
db.url.0=jdbc:mysql://mysqlhost:3306/yunpower_config?characterEncoding=utf8&connectTimeout=10000&socketTimeout=30000&autoReconnect=true&useUnicode=true&useSSL=false&serverTimezone=UTC
db.user=root
db.password=123456
~~~

#### 4. 启动项目
前面所安装软件正常启动后就可以启动项目了。

1. 服务系统启动，以下4个是必启的：
```
YunPowerGatewayApplication （网关模块 必须）
YunPowerAuthApplication    （认证模块 必须）
YunPowerSystemApplication  （系统模块 必须）
YunPowerDataViewApplication（数据模块 必须）
```

2. 采集系统启动
```
YunPowerCollectBizApplication
```

3. 前端启动
```
（1）node.js 安装最新的即可
（2）配置host:这个要看当地的运营商，如果 npm install 能成功，那就不需要配置
    185.199.110.133 raw.githubusercontent.com
（3）安装项目依赖：npm install
（4）启动项目：npm run dev
```
4. 接线图启动
```
同前端启动
```
